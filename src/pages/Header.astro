---
import { translations } from "../translations/Translations.js";
---

<header
    class="fixed top-0 left-0 w-full z-50 bg-theme-bg/90 backdrop-blur-md border-b border-theme-border transition-all duration-300"
>
    <div
        class="max-w-7xl mx-auto px-6 md:px-12 h-24 flex items-center justify-between relative"
    >
        <div class="flex flex-col items-start justify-center gap-1">
            <a href="/" class="z-50 group flex-shrink-0">
                <span
                    class="font-montserrat font-medium text-[20px] md:text-[25px] leading-tight tracking-tight text-theme-text transition-opacity hover:opacity-80"
                >
                    marcosgonzalez.dev
                </span>
            </a>

            <nav
                class="flex md:hidden items-center gap-0 bg-theme-card/50 p-[2px] rounded border border-theme-border"
            >
                <button
                    id="mob-btn-dev"
                    class="px-2 py-0.5 rounded text-[10px] font-montserrat font-bold tracking-wide transition-all duration-300"
                    onclick="switchMode('dev')"
                    data-lang="nav.dev"
                >
                    DEV
                </button>
                <div class="w-[1px] h-3 bg-theme-border mx-1"></div>
                <button
                    id="mob-btn-sec"
                    class="px-2 py-0.5 rounded text-[10px] font-montserrat font-bold tracking-wide transition-all duration-300"
                    onclick="switchMode('sec')"
                    data-lang="nav.sec"
                >
                    SEC
                </button>
            </nav>
        </div>

        <nav
            class="hidden md:flex items-center gap-1 bg-theme-card p-1 rounded-full border border-theme-border absolute left-1/2 transform -translate-x-1/2"
        >
            <button
                id="btn-dev"
                class="mode-btn px-5 py-2 rounded-full text-xs font-montserrat font-bold tracking-wide transition-all duration-300"
                onclick="switchMode('dev')"
                data-lang="nav.dev"
            >
                DESARROLLO
            </button>
            <button
                id="btn-sec"
                class="mode-btn px-5 py-2 rounded-full text-xs font-montserrat font-bold tracking-wide transition-all duration-300"
                onclick="switchMode('sec')"
                data-lang="nav.sec"
            >
                CIBERSEGURIDAD
            </button>
        </nav>

        <div class="flex items-center gap-3 md:gap-6">
            <div
                class="hidden md:flex items-center gap-6 border-r border-theme-border pr-6"
            >
                <a
                    href="#"
                    class="relative group font-montserrat font-medium text-sm text-theme-muted hover:text-theme-text transition-colors flex items-center gap-2"
                >
                    <span data-lang="nav.blog">blog</span>
                    <span
                        class="absolute -bottom-1 left-0 w-0 h-[1px] bg-theme-text transition-all duration-300 ease-out group-hover:w-full"
                    ></span>
                </a>

                <a
                    href="https://github.com/marcosgonzalez-dev"
                    target="_blank"
                    class="relative group font-montserrat font-medium text-sm text-theme-muted hover:text-theme-text transition-colors flex items-center gap-2"
                >
                    <span>github</span>
                    <span
                        class="absolute -bottom-1 left-0 w-0 h-[1px] bg-theme-text transition-all duration-300 ease-out group-hover:w-full"
                    ></span>
                </a>

                <a
                    href="https://www.linkedin.com/in/marcosgonzalezchavez/"
                    target="_blank"
                    class="relative group font-montserrat font-medium text-sm text-theme-muted hover:text-theme-text transition-colors flex items-center gap-2"
                >
                    <span>linkedIn</span>
                    <span
                        class="absolute -bottom-1 left-0 w-0 h-[1px] bg-theme-text transition-all duration-300 ease-out group-hover:w-full"
                    ></span>
                </a>
            </div>

            <div class="flex items-center gap-2 md:gap-3">
                <button
                    id="theme-toggle"
                    class="p-2 rounded-full hover:bg-theme-muted/10 text-theme-text transition-colors"
                    aria-label="Toggle Theme"
                >
                    <svg
                        id="icon-sun"
                        class="hidden"
                        xmlns="http://www.w3.org/2000/svg"
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        ><circle cx="12" cy="12" r="5"></circle><path
                            d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"
                        ></path></svg
                    >
                    <svg
                        id="icon-moon"
                        xmlns="http://www.w3.org/2000/svg"
                        width="20"
                        height="20"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        ><path
                            d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
                        ></path></svg
                    >
                </button>

                <button
                    id="lang-toggle"
                    class="w-8 h-8 flex items-center justify-center rounded-full border border-theme-border text-[10px] font-bold font-mono text-theme-text hover:border-theme-text transition-colors"
                >
                    ES
                </button>
            </div>

            <button id="menu-toggle" class="md:hidden text-theme-text p-1 ml-1">
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="28"
                    height="28"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    ><line x1="3" y1="12" x2="21" y2="12"></line><line
                        x1="3"
                        y1="6"
                        x2="21"
                        y2="6"></line><line x1="3" y1="18" x2="21" y2="18"
                    ></line></svg
                >
            </button>
        </div>
    </div>

    <div
        id="mobile-menu"
        class="absolute top-[80px] right-0 w-auto transform translate-x-full transition-transform duration-300 md:hidden flex flex-col items-end py-4 px-6 gap-8 z-50"
    >
        <span
            class="text-theme-muted text-[10px] font-mono tracking-[0.2em] border-b border-theme-text/10 pb-1"
            data-lang="nav.menu">// Navegación</span
        >

        <a
            href="#"
            class="relative group block w-fit font-montserrat font-medium text-sm text-theme-muted hover:text-theme-text transition-colors"
            onclick="closeMenu()"
        >
            <span data-lang="nav.blog">blog</span>
            <span
                class="absolute -bottom-1 left-0 w-0 h-[2px] bg-theme-text transition-all duration-300 ease-out group-hover:w-full"
            ></span>
        </a>

        <a
            href="https://github.com/marcosgonzalez-dev"
            target="_blank"
            class="relative group block w-fit font-montserrat font-medium text-sm text-theme-muted hover:text-theme-text transition-colors"
            onclick="closeMenu()"
        >
            GitHub
            <span
                class="absolute -bottom-1 left-0 w-0 h-[2px] bg-theme-text transition-all duration-300 ease-out group-hover:w-full"
            ></span>
        </a>

        <a
            href="https://www.linkedin.com/in/marcosgonzalezchavez/"
            target="_blank"
            class="relative group block w-fit font-montserrat font-medium text-sm text-theme-muted hover:text-theme-text transition-colors"
            onclick="closeMenu()"
        >
            LinkedIn
            <span
                class="absolute -bottom-1 left-0 w-0 h-[2px] bg-theme-text transition-all duration-300 ease-out group-hover:w-full"
            ></span>
        </a>
    </div>
</header>

<script is:inline define:vars={{ translations }}>
    // --- LÓGICA MENÚ HAMBURGUESA ---
    const menuToggle = document.getElementById("menu-toggle");
    const mobileMenu = document.getElementById("mobile-menu");

    menuToggle?.addEventListener("click", () => {
        mobileMenu.classList.toggle("translate-x-full");
    });

    window.closeMenu = function () {
        mobileMenu?.classList.add("translate-x-full");
    };

    // --- LÓGICA IDIOMA ---
    const langToggle = document.getElementById("lang-toggle");
    let currentLang = localStorage.getItem("lang") || "es";

    function updateTexts(lang) {
        document.querySelectorAll("[data-lang]").forEach((element) => {
            const key = element.getAttribute("data-lang");
            // Soporte para anidado (nav.blog) o plano
            if (translations[lang] && translations[lang][key]) {
                element.innerHTML = translations[lang][key];
            }
        });
    }

    function setLanguage(lang) {
        currentLang = lang;
        localStorage.setItem("lang", lang);
        if (langToggle) langToggle.textContent = lang.toUpperCase();
        updateTexts(lang);
    }

    document.addEventListener("DOMContentLoaded", () =>
        setLanguage(currentLang),
    );

    langToggle?.addEventListener("click", () => {
        const newLang = currentLang === "es" ? "en" : "es";
        setLanguage(newLang);
    });

    // --- LÓGICA TEMA ---
    const themeToggle = document.getElementById("theme-toggle");
    const iconSun = document.getElementById("icon-sun");
    const iconMoon = document.getElementById("icon-moon");
    const html = document.documentElement;

    function setTheme(isLight) {
        if (isLight) {
            html.setAttribute("data-theme", "light");
            iconSun?.classList.remove("hidden");
            iconMoon?.classList.add("hidden");
            localStorage.setItem("theme", "light");
        } else {
            html.removeAttribute("data-theme");
            iconSun?.classList.add("hidden");
            iconMoon?.classList.remove("hidden");
            localStorage.setItem("theme", "dark");
        }
        // Repintar botones al cambiar tema
        const currentMode = localStorage.getItem("mode") || "dev";
        if (window.switchMode) window.switchMode(currentMode);
    }

    const savedTheme = localStorage.getItem("theme") === "light";
    setTheme(savedTheme);

    themeToggle?.addEventListener("click", () => {
        setTheme(!html.hasAttribute("data-theme"));
    });

    // --- LÓGICA MODOS (ACTUALIZADA PARA INCLUIR MÓVIL) ---
    window.switchMode = function (mode) {
        // 1. Botones PC
        const btnDev = document.getElementById("btn-dev");
        const btnSec = document.getElementById("btn-sec");

        // 2. Botones Móvil (NUEVOS)
        const mobDev = document.getElementById("mob-btn-dev");
        const mobSec = document.getElementById("mob-btn-sec");

        // 3. Contenido (IDs originales del script anterior)
        const viewDev = document.getElementById("view-dev"); // O "content-dev" si lo cambiaste
        const viewSec = document.getElementById("view-sec"); // O "content-sec" si lo cambiaste

        localStorage.setItem("mode", mode);

        // Estilos
        const setActive = (el) => {
            if (!el) return;
            el.style.backgroundColor = "var(--color-theme-text)";
            el.style.color = "var(--color-theme-bg)";
            el.style.opacity = "1";
            el.style.boxShadow = "0 0 10px rgba(125,125,125,0.2)";
        };
        const setInactive = (el) => {
            if (!el) return;
            el.style.backgroundColor = "transparent";
            el.style.color = "var(--color-theme-text)";
            el.style.opacity = "0.6";
            el.style.boxShadow = "none";
        };

        if (mode === "dev") {
            // PC
            setActive(btnDev);
            setInactive(btnSec);
            // Móvil
            setActive(mobDev);
            setInactive(mobSec);

            // Contenido
            if (viewDev && viewSec) {
                viewDev.classList.remove("hidden");
                viewDev.style.display = "block";
                viewSec.classList.add("hidden");
                viewSec.style.display = "none";
            }
        } else {
            // PC
            setInactive(btnDev);
            setActive(btnSec);
            // Móvil
            setInactive(mobDev);
            setActive(mobSec);

            // Contenido
            if (viewDev && viewSec) {
                viewSec.classList.remove("hidden");
                viewSec.style.display = "block";
                viewDev.classList.add("hidden");
                viewDev.style.display = "none";
            }
        }

        // Refrescar animaciones
        setTimeout(
            () => window.ScrollTrigger && window.ScrollTrigger.refresh(),
            100,
        );
    };

    document.addEventListener("DOMContentLoaded", () => {
        const savedMode = localStorage.getItem("mode") || "dev";
        window.switchMode(savedMode);
    });
</script>
